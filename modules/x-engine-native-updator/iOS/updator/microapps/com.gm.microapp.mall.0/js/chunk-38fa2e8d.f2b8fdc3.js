(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38fa2e8d"],{"368b":function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"big_box"},[s("GmHeader",{attrs:{hideItem:["center"],slotsShow:["right"],leftText:"","background-color":"#fff"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.Code,expression:"Code"}],attrs:{slot:"dynamicsRight"},slot:"dynamicsRight"},[t.environment?s("van-uploader",{attrs:{"after-read":t.afterRead}},[s("div",{staticClass:"seng_msg_btn btn_success"},[t._v("发贴")])]):s("div",{staticClass:"seng_msg_btn btn_success",on:{click:t.showPhoto}},[t._v("发贴")])],1)]),s("div",{staticClass:"box_back"},[1==t.flag?s("Ordinary",{attrs:{topicObj:t.topicObj}}):t._e()],1),s("listPagination",{attrs:{"data-list":t.topicsList,formatAjaxData:t.getTopics,isRefresh:t.isRefresh,slotsShow:["finished","error"]},on:{"update:dataList":function(i){t.topicsList=i},"update:data-list":function(i){t.topicsList=i},"update:isRefresh":function(i){t.isRefresh=i},"update:is-refresh":function(i){t.isRefresh=i}},scopedSlots:t._u([{key:"finished",fn:function(){return[s("div",{staticClass:"reminder"},[t.topicsList.length?s("div",[t._v("没有更多了")]):s("div",{staticClass:"error-body"},[s("div",[s("img",{staticClass:"img-login",attrs:{src:e("e3bb"),alt:""}})]),s("div",{staticClass:"error-text"},[t._v("暂无帖子")])])])]},proxy:!0},{key:"error",fn:function(){return[s("div",[t._v("请求失败，点击重新加载")])]},proxy:!0}])},[s("div",[s("topicCom",{attrs:{topicsList:t.topicsList}})],1)])],1)},o=[],r=e("2909"),a=(e("c975"),e("d3b7"),e("d81d"),e("ac1f"),e("1276"),e("25f0"),function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("div",{staticClass:"topicality"},[e("div",{staticClass:"content_header"},[e("div",{staticClass:"header_one"},[e("img",{attrs:{width:"100px",height:"100px",src:""+t.topicObj.pictureUrl}})]),e("div",{staticClass:"header_two"},[e("p",[t._v(t._s(t.topicObj.topicName))]),e("span",[t._v(t._s(t.topicObj.postCommentNum)+" 帖子")])])]),e("div",{staticClass:"txt"},[t._v(" "+t._s(t.topicObj.mainBody)+" ")])])])}),n=[],c={props:["topicObj"],data:function(){return{}}},u=c,l=(e("a0cb"),e("2877")),p=Object(l["a"])(u,a,n,!1,null,"0c5a9d98",null),d=p.exports,h=e("e5ea"),f={components:{Ordinary:d,topicCom:h["a"]},data:function(){return{isRefresh:!1,topicObj:[],environment:this.$utils.isMiniprogram(),flag:1,pageSize:10,articleInfo:[],Code:!0,topicsList:[]}},created:function(){var t=this;this.$utils.isMiniprogram()&&this.$route.query.userToken&&(this.$utils.storage.set("userToken",this.$route.query.userToken),this.$utils.storage.set("sessionToken",this.$route.query.sessionToken),this.$utils.storage.set("GMJUserInfo",this.$route.query.userInfo)),this.$utils.isMiniprogram()&&this.$route.query.mallCode&&(this.$utils.storage.set("mallCode",this.$route.query.mallCode),this.$utils.storage.set("homecityCode",this.$route.query.cityCode)),this.$utils.storage.set("fileArr",[]);var i={id:this.$route.query.id,pageNumber:this.pageNumber,pageSize:this.pageSize};this.visibilityEve(),this.$api.view(i).then((function(i){t.topicObj=i.data,t.topicObj.mallCode&&-1!==t.topicObj.mallCode.indexOf(t.$mallCode)?t.Code=!0:t.Code=!1}))},beforeDestroy:function(){},methods:{visibilityEve:function(){var t=this;this.$utils.visibilityEve((function(){"/topic"===t.$route.path&&t.getTopics({page:1})}))},getTopics:function(t){var i=this;return new Promise((function(e,s){var o=i;1===t.page&&(i.topicsList=[]),o.$api.getTopicPage({pageNumber:t.page,pageSize:o.pageSize,communityId:i.$route.query.id}).then((function(t){var a=t.data;if(a){var n,c=0;c=~~(a.total/o.pageSize),a.total%o.pageSize>0&&++c;var u={pageCount:c,list:[]};a.records&&(u.list=JSON.parse(JSON.stringify(a.records)),u.list.map((function(t){return t.imgArr=t.pictureUrl?t.pictureUrl.split(","):[],t.likeColor=t.likeFlag.toString()&&"1"!==t.likeFlag.toString(),t.memberPhotoUrl&&-1!==t.memberPhotoUrl.indexOf("https")&&(t.memberPhotoUrl="http:"+t.memberPhotoUrl.split(":")[1]),t}))),(n=i.topicsList).push.apply(n,Object(r["a"])(u.list)),e(u)}else s()})).catch((function(t){console.error(t),s(t)}))}))},afterRead:function(t){var i=[{fileName:t.file.name,retImage:t.content.split(",")[1]}];this.$utils.storage.set("fileArr",JSON.stringify(i)),this.jumpRouter()},showPhoto:function(t){var i=this;this.$engine.api("com.zkty.jsi.camera","openImagePicker",{allowsEditing:!1,savePhotosAlbum:!1,cameraFlashMode:-1,cameraDevice:"back",photoCount:9,args:{bytes:"100"},isbase64:!0},(function(t){i.$utils.storage.set("fileArr",JSON.parse(t).data),i.jumpRouter()}))},jumpRouter:function(){if(this.$utils.isMiniprogram())window.wx.miniProgram.navigateTo({url:"/pages/forum/sendMsg/sendMsg?webviewUrl="+encodeURIComponent("/postMsg?activityId="+this.topicObj.activityId+"&id="+this.topicObj.id)});else{var t={activityId:this.topicObj.activityId,id:this.topicObj.id};this.$router.push({path:"/postMsg",query:t})}}}},m=f,g=(e("5c9b"),Object(l["a"])(m,s,o,!1,null,"04de9148",null));i["default"]=g.exports},3753:function(t,i,e){},4346:function(t,i,e){},"5c9b":function(t,i,e){"use strict";e("3753")},a0cb:function(t,i,e){"use strict";e("4346")}}]);