(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50fc10fa"],{"048b":function(t,e,i){},"0ecd":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post_msg"},[s("GmHeader",{attrs:{slotsShow:["center","right"],leftText:"发帖"}},[s("div",{attrs:{slot:"dynamicsRight"},slot:"dynamicsRight"},[s("div",{staticClass:"seng_msg_btn",class:[t.postMsgShow?"btn_success":"btn_gray"],on:{click:t.postMsgFun}},[t._v("发布")])])]),s("div",[s("van-field",{attrs:{rows:"5",maxHeight:"200",type:"textarea",maxlength:"1000",placeholder:"这一刻的想法...","show-word-limit":""},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}}),s("div",{staticStyle:{padding:"15px 20px",width:"100%",overflow:"hidden"}},[s("ul",{staticClass:"phone_ul"},[t._l(t.reviewsImg,(function(e,i){return s("li",{key:i,attrs:{s:""}},[s("div",{staticClass:"img_dev",staticStyle:{position:"relative"}},[s("van-image",{attrs:{fit:"cover",src:e,"error-icon":t.defaultAvatar},on:{click:function(e){return t.reviewImg(t.reviewsImg,i)}}}),s("span",{staticClass:"dele-icon",on:{click:function(e){return t.deleImg(i)}}})],1)])})),t.reviewsImg.length<9?s("li",[s("div",[t.environment?s("van-uploader",{attrs:{"after-read":t.afterRead}}):s("div",{staticClass:"upload_add",on:{click:t.showPhotoFun}},[s("van-icon",{attrs:{name:"plus",color:"#D8D8D8",size:"30"}})],1)],1)]):t._e()],2)]),s("div",[s("van-cell",{scopedSlots:t._u([{key:"title",fn:function(){return[s("div",{staticClass:"address_show"},[s("img",{staticClass:"icon_img",attrs:{src:i("f602")}}),s("span",{staticClass:"custom-title"},[t._v(t._s(t.topicParams.topicName))])])]},proxy:!0}])}),s("van-cell",{scopedSlots:t._u([{key:"title",fn:function(){return[s("div",{staticClass:"address_show"},[s("img",{staticClass:"icon_img",attrs:{src:i("deb5")}}),s("span",{staticClass:"custom-title"},[t._v(t._s(t.addressName))])])]},proxy:!0}])})],1)],1)],1)},A=[],a=(i("d81d"),i("ac1f"),i("1276"),i("d3b7"),i("a434"),i("a15b"),i("28a2")),r=i("ee87"),o={data:function(){return{topicType:"",addressName:"",topicParams:{},routerParams:{},defaultAvatar:r,remark:"",reviewsImg:[],environment:this.$utils.isMiniprogram()}},computed:{postMsgShow:function(){return this.reviewsImg.length>0&&this.remark}},created:function(){var t=this;this.$utils.isMiniprogram()&&this.$route.query.userToken&&(this.$utils.storage.set("userToken",this.$route.query.userToken),this.$utils.storage.set("sessionToken",this.$route.query.sessionToken),this.$utils.storage.set("GMJUserInfo",this.$route.query.userInfo)),this.$utils.isMiniprogram()&&this.$route.query.mallCode&&(this.$utils.storage.set("mallCode",this.$route.query.mallCode),this.$utils.storage.set("homecityCode",this.$route.query.cityCode));var e=this,i=e.$route.query;e.routerParams=i;this.$utils.getSysUserInfo();e.getActivity();var s=JSON.parse(this.$utils.storage.get("fileArr"));s.length>0&&s.map((function(e){t.upLoadImg(e.fileName,e.retImage)}))},methods:{afterRead:function(t){this.upLoadImg(t.file.name,t.content.split(",")[1])},showPhotoFun:function(){var t=this;this.$utils.storage.set("fileArr",[]),t.reviewsImg.length<9?t.$engine.api("com.zkty.jsi.camera","openImagePicker",{allowsEditing:!1,savePhotosAlbum:!1,cameraFlashMode:-1,cameraDevice:"back",photoCount:9,args:{bytes:"100"},isbase64:!0},(function(e){var i=JSON.parse(e).data;i.length>0&&i.map((function(e){t.upLoadImg(e.fileName,e.retImage)}))})):t.$toast("最多可上传9张")},upLoadImg:function(t,e){var i=this;this.toast();var s={fileName:t,base64Str:e};this.$api.uploadBase64(s).then((function(t){0===t.code&&(i.$toast.clear(),i.reviewsImg.push(t.data.res.url))})).finally((function(t){}))},deleImg:function(t){this.reviewsImg.splice(t,1)},reviewImg:function(t,e){Object(a["a"])({images:t,startPosition:e,showIndex:!1,closeable:!0,closeIcon:"arrow-left",closeIconPosition:"top-left"})},toast:function(){this.$toast.loading({duration:0,type:"loading",message:"加载中...",forbidClick:!0})},getActivity:function(){var t=this,e=this;e.$api.getTopicDetail({id:e.routerParams.id}).then((function(i){t.addressName="NEIGHBORHOODTOPIC"===i.data.topicType?t.$mallName+" "+JSON.parse(localStorage.getItem("select")):t.$mallName,e.topicParams=i.data,e.topicType=i.data.type}))},postMsgFun:function(){var t=this,e=this;if(e.postMsgShow){var i=this.$utils.getSysUserInfo(),s="NEIGHBORHOODTOPIC"===e.topicType?this.$utils.storage.get("addresId"):"",A={communityId:e.routerParams.id,pictureUrl:e.reviewsImg.join(","),mainBody:e.remark,topicType:e.topicType,status:"NORMAL",userNickname:e.environment?i.nickname:i.customerUser.nickname,userPhone:e.environment?i.phoneNum:i.customerUser.phoneNum,mallCode:e.$mallCode,mallName:e.$mallName,residentialId:s,crtUserId:e.$utils.getUserId()},a=this.$toast.loading({duration:0,type:"loading",message:"保存中...",forbidClick:!0});e.$api.saveInsertTopic(A).then((function(e){a.clear(),0===e.code&&(t.updateTopics(),t.$toast.success("保存成功！"),t.$utils.isMiniprogram()?window.wx.miniProgram.navigateBack({delta:1}):t.$router.go(-1))})).catch((function(){t.$toast.fail("保存失败"),a.clear()}))}},updateTopics:function(){this.$api.updatePost({id:this.routerParams.id}).then((function(t){}))}},beforeDestroy:function(){this.$utils.storage.set("fileArr",null)}},n=o,l=(i("8b95"),i("2877")),c=Object(l["a"])(n,s,A,!1,null,"0bd3ec6c",null);e["default"]=c.exports},"8b95":function(t,e,i){"use strict";i("048b")},a434:function(t,e,i){"use strict";var s=i("23e7"),A=i("23cb"),a=i("a691"),r=i("50c4"),o=i("7b0b"),n=i("65f0"),l=i("8418"),c=i("1dde"),u=c("splice"),m=Math.max,d=Math.min,g=9007199254740991,p="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!u},{splice:function(t,e){var i,s,c,u,h,f,v=o(this),w=r(v.length),y=A(t,w),I=arguments.length;if(0===I?i=s=0:1===I?(i=0,s=w-y):(i=I-2,s=d(m(a(e),0),w-y)),w+i-s>g)throw TypeError(p);for(c=n(v,s),u=0;u<s;u++)h=y+u,h in v&&l(c,u,v[h]);if(c.length=s,i<s){for(u=y;u<w-s;u++)h=u+s,f=u+i,h in v?v[f]=v[h]:delete v[f];for(u=w;u>w-s+i;u--)delete v[u-1]}else if(i>s)for(u=w-s;u>y;u--)h=u+s-1,f=u+i-1,h in v?v[f]=v[h]:delete v[f];for(u=0;u<i;u++)v[u+y]=arguments[u+2];return v.length=w-s+i,c}})},deb5:function(t,e){t.exports="data:image/png;base64,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"},ee87:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAMAAABlApw1AAAAP1BMVEUAAAD4+Pj39/f29vb19fXw8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///8zJ5QuAAAABXRSTlMAJD2/7XxuZKkAAALNSURBVHja7dtrcqswDAVgEcDGIq4h1v7Xen/caZs2IQW/iqbnrEBfxgcZZkJEXc9K03dERJeBnTWjuhjreLgQdQNPo9JMPHTU651/HCfuid2oOI6JrWaAZWKjGWCYeFQdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACax1zXGNer0QpwUUREJDqdgPf5UwRnAJiP+UWiUQi4yl2uCgHrPWBVCIj3gAgAjtDfK7H6x+jpFtl0nac0wTmuEl5ExOu9zPn/P6ZvdPyKAzJOwykA9rOPViVgTV9JpwCE+50U9AFm+ZJZG2CKXwFx0gUwN/mWm1EFWOQhiyaAlyfxegAsT8NaAN8L3KrIpQCPBX5dZMOF/r9WChBkM8/22TWKxPlEAC8v4rcW3nwagIuvAA8X0/e+lOhHEYB9Of/DxfSzLwUWXRHAKj9k3epLOAUgyI8Jpb6i1ADMsiPzxsLIrkE+YIp7AB+Dfl8YuTXIBmxvsOeDhj1roiVgkZ1ZHgtQoga5AC+74zcWRt73i0wAy4HwxnnLqkEeYF+BP4u8vDpdvwDYW+APwf7bUhtAkELJqEEOwEuxpH/GywC4WA6Q/hkvHWBLzi/y1hywStlwY0AoPH9qDVIBsxTP2hIwxfKAtBqkAY5usJ2ZmwGWKvMnvd0kAbxUymqaAFiqJbQAVClw8tvNcUClAqfW4DggSNUcfbs5DPBSOaEuwMXagIM1OAiw9ec/+HZzELBKgxyqwTHALE3yVg0Q2gBuAPzyEfL1SrwoL/E4+lvtB+ntzdS9SpwsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAGM3zGya2mgGWiZ1mgGPqedI7/8Q9dYNewcRDR3QZ2FmFTTbW8XAhIup6Vpq+I/oHlUqlUPej+ikAAAAASUVORK5CYII="},f602:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAC9UlEQVRYR8WXPWgVQRDH/xPie4WIVYSo4Ac2cfeCYhQsRO2CoIWSYKGQQiKKjSg2CprCws9O8KMwaKVBLaJYJpZiHg+TuZc0wSgSIWmEoIXkbuSO3HF3b+8jvhez3e3OzvzmY2f3CKs8aLn2Ozs7NzuOc4CIdotIGxFtALAAYBzA53K5PFKpVH4X1VsYwLKsfhHpA7C/gPLXIjJs2/ZgnmwugFKqj4guANiTpyy5LiKDjuMMTE1NzaTtzQRQSj0lIs/rRsY3ANeY+blJSSqAZVnvRaS7EcuJvQPMfCOpzwigtfYErzfRuK+KiHonJiaGonrrAFbKeMToUWZ+G3zHADo6OtpbW1vHRGRjhve/AHwCsBfA2iU501yaimFmPmYEKOj9PWa+rLW+C+DSkiLTXFYGwyjEIqCU+kJEW3Ny7xdTAtY0l6XmDTMf9+sikLIsq0dEXhYovGYAeGZ2MPN0CKC19oz3GAAWROQVEX0N1iIRCMWTcyKyhYhOAFiX4pTvSBSgCmCXQXiUmQ8XiEydiNZ6BMChlL0PmflcFOA7gE0mYRF5TEQ/lhmBdiLqzwD36yAK8AfAmgKeNqsG/MhGAX4CWL+aANMAttf1aqJZ13VvElEtkoJRrXUst8wcmxORnS0tLVczmlpdBD4C2GeIQIWZuwpExlSEYxnX+BAz90ZT8ADAeZMhIrJFZH5p7UPkyB1MmyOiNhFRaeDBxRQF8ELqHZu80XARisiMbdvbYp3Q+9BazwFoyyFoGABA+DaI3QVa69Q0BFBeT7Bt+6xS6lFwzk1zGaGfXVxc7JqcnPT7ShKgaBry0pS1HnsZ/W+AF8x8MkqXvI7PENGTRtzL2DvuOE53EPpALhmBdwCONBvAO8au6/bath02szoAy7JuiciVFTBedV33lMl4WIRKqYtEdL/Jxr3fszvlcvl21q8aaa1PA3jWROPDRDTiOM5orVbz3hiZwwNIezDk7Q3XRWSuVCrNV6vVoF0X3pv7b1hY0z8K/gWSX4MwlrsLLwAAAABJRU5ErkJggg=="}}]);