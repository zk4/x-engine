(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57aec432"],{"0a45":function(t,e,i){},2532:function(t,e,i){"use strict";var s=i("23e7"),a=i("5a34"),n=i("1d80"),r=i("ab13");s({target:"String",proto:!0,forced:!r("includes")},{includes:function(t){return!!~String(n(this)).indexOf(a(t),arguments.length>1?arguments[1]:void 0)}})},"4f2c":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"input_con"},[i("ul",[i("li",{staticClass:"input_cell"},[i("span",[t._v("人数")]),i("span",{staticClass:"font_show"},[t._v(t._s(t.topicPostObj.applyUserNum))])]),i("li",{staticClass:"input_cell"},[i("span",[t._v("联系人")]),i("span",{staticClass:"font_show"},[t._v(t._s(t.topicPostObj.contactName))])]),i("li",{staticClass:"input_cell"},[i("span",[t._v("联系方式")]),i("span",{staticClass:"font_show"},[t._v(t._s(t.topicPostObj.contactNamePhone))])]),i("li",{staticClass:"input_cell"},[i("span",[t._v("备注")]),i("span",{staticClass:"last_font"},[t._v(" "+t._s(t.topicPostObj.remark)+" ")])])])]),t._m(0)])},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"btn_back"},[i("div",{staticClass:"btn_submit"},[t._v("已报名")])])}],n={data:function(){return{}},props:{topicPostObj:{type:Object,default:function(){}}},methods:{}},r=n,o=(i("c623"),i("2877")),c=Object(o["a"])(r,s,a,!1,null,"529f8e9d",null);e["a"]=c.exports},"5a34":function(t,e,i){var s=i("44e7");t.exports=function(t){if(s(t))throw TypeError("The method doesn't accept regular expressions");return t}},6746:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"topicPost"},[s("div",[s("div",{staticClass:"topics_title"},[s("div",[s("img",{staticClass:"head_img",attrs:{width:"100px",height:"100px",src:""+t.topicParams.pictureUrl}})]),s("div",{staticStyle:{"margin-left":"10px"}},[s("p",{staticClass:"title_right"},[s("img",{attrs:{src:i("f602")}}),s("strong",[t._v(t._s(t.topicParams.topicName))])]),s("div",[s("label",{staticClass:"topics_num"},[t._v(t._s(t.topicParams.postCommentNum)+"帖子")])]),s("div",{staticClass:"person_num"},[s("label",[t._v("报名人数："+t._s(t.topicsObj.alreadyApplyUserNum)+"/"+t._s(t.topicsObj.applyLimitUserNum)+"人")])])])]),s("div",{class:{topics_desc:t.showAll}},[t._v(" "+t._s(t.topicParams.mainBody)+" ")]),t.topicParams.mainBody?s("div",{staticClass:"show_all_btn"},[s("span",{on:{click:t.showAllFun}},[t._v(t._s(t.showAll?"展开全部":"收缩"))])]):t._e()])])},a=[],n=(i("ac1f"),i("1276"),{data:function(){return{showAll:!0,topicParams:{}}},props:{paramsObj:{type:Object,default:function(){}},routerParams:{type:Object,default:function(){}}},computed:{topicsObj:function(){return this.paramsObj}},created:function(){this.getActivity()},methods:{showAllFun:function(){var t=this;t.showAll=!t.showAll},getActivity:function(){var t=this;t.$api.getTopicDetail({id:t.routerParams.id}).then((function(e){e.data.pictureUrl&&(e.data.pictureUrl="http:"+e.data.pictureUrl.split(":")[1]),t.topicParams=e.data}))}}}),r=n,o=(i("9844"),i("2877")),c=Object(o["a"])(r,s,a,!1,null,"4d94eea3",null);e["a"]=c.exports},"7bfc":function(t,e,i){"use strict";i("a953")},9844:function(t,e,i){"use strict";i("ea7f")},"9e2a":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sign_up"},[t.environment?t._e():i("div",[i("GmHeader",{attrs:{slotsShow:["center","right"],leftText:"活动报名"}})],1),i("div",{staticClass:"title_show",class:{margin60:t.environment}},[i("topicPost",{attrs:{paramsObj:t.paramsObj,routerParams:t.routerParams}})],1),t.topicPostDetial?i("div",[i("topicDetail",{attrs:{topicPostObj:t.topicPostObj}})],1):i("div",[i("div",{staticClass:"input_con"},[i("ul",[i("li",{staticClass:"input_cell"},[i("span",[t._v("人数")]),i("div",{staticClass:"step_num"},[i("span",{staticStyle:{"padding-right":"5px"}},[t._v("限1-"+t._s(t.maxStep)+"人")]),i("van-stepper",{attrs:{min:"1",max:t.maxStep},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)]),i("li",{staticClass:"input_cell"},[i("span",[t._v("联系人")]),i("span",[i("van-field",{attrs:{maxlength:"5",placeholder:"联系人"},model:{value:t.signUpObj.userName,callback:function(e){t.$set(t.signUpObj,"userName",e)},expression:"signUpObj.userName"}})],1)]),i("li",{staticClass:"input_cell"},[i("span",[t._v("联系方式")]),i("span",[i("van-field",{attrs:{maxlength:"11",placeholder:"联系方式"},model:{value:t.signUpObj.userTel,callback:function(e){t.$set(t.signUpObj,"userTel",e)},expression:"signUpObj.userTel"}})],1)]),i("li",{staticClass:"input_cell"},[i("span",[t._v("备注")]),i("span",[i("van-field",{attrs:{placeholder:"选填",maxlength:"15"},model:{value:t.signUpObj.remark,callback:function(e){t.$set(t.signUpObj,"remark",e)},expression:"signUpObj.remark"}})],1)])])]),i("div",{staticClass:"btn_back"},[i("div",{staticClass:"btn_submit",on:{click:t.submitFun}},[t._v("提交")])])])])},a=[],n=(i("caad"),i("2532"),i("d81d"),i("d3b7"),i("c1df")),r=i.n(n),o=i("6746"),c=i("4f2c"),l={components:{topicPost:o["a"],topicDetail:c["a"]},data:function(){return{environment:this.$utils.isMiniprogram(),topicPostDetial:!1,topicPostObj:{},memberLevel:"",routerParams:{},activityId:"",paramsObj:{},value:1,maxStep:3,signUpObj:{userName:"",userTel:"",remark:""}}},created:function(){var t=this;this.$utils.isMiniprogram()&&this.$route.query.userToken&&(this.$utils.storage.set("userToken",this.$route.query.userToken),this.$utils.storage.set("sessionToken",this.$route.query.sessionToken),this.$utils.storage.set("GMJUserInfo",this.$route.query.userInfo)),this.$utils.isMiniprogram()&&this.$route.query.mallCode&&(this.$utils.storage.set("mallCode",this.$route.query.mallCode),this.$utils.storage.set("homecityCode",this.$route.query.cityCode));var e=this.$route.query;this.routerParams=e,this.activityId=e.activityId,this.getActivityDetail().then((function(){t.getMemberUserInfo()})),this.getInit()},methods:{getInit:function(){var t=this;t.$api.getActivityView({id:this.activityId}).then((function(e){t.paramsObj=e.data,t.maxStep=e.data.applyLimitUserNum}))},submitFun:function(){var t=this,e=this;if(e.judgeSignUp()){var i={activityId:e.activityId,applyUserNum:e.value,contactName:e.signUpObj.userName,contactNamePhone:e.signUpObj.userTel,crtTime:r()(new Date).format("YYYY-MM-DD HH:mm:ss"),crtUserId:e.$utils.getUserId(),remark:e.signUpObj.remark};e.$api.saveActivity(i).then((function(i){0===i.code&&t.$dialog.alert({message:"活动报名已成功！"}).then((function(){e.$utils.isMiniprogram()?window.wx.miniProgram.navigateBack({delta:1}):e.$router.go(-1)}))}))}},judgeSignUp:function(){var t=this,e=this,i=JSON.parse(JSON.stringify(e.paramsObj.memberLevel)),s=e.chageMember(e.memberLevel);return i.includes(s)?e.signUpObj.userName?e.signUpObj.userTel?!!this.$utils.isTruePhone("86",e.signUpObj.userTel)||(this.$toast("请输入正确手机号！"),!1):(e.$toast("请输入联系电话！"),!1):(e.$toast("请输入联系人！"),!1):(e.$dialog.confirm({title:"",confirmButtonText:"查看会员等级",message:"该活动仅限 "+i+" 参与"}).then((function(){t.$utils.isMiniprogram()?window.wx.miniProgram.navigateTo({url:"/pages/memberCenterWebview/memberCenterWebview?webviewUrl="+encodeURIComponent("/memberCenter?mallCode="+t.$mallCode+"&cityCode="+t.$cityCode)}):t.$router.push({path:"/memberCenter"})})).catch((function(){})),!1)},getMemberUserInfo:function(){var t={userId:this.$utils.getUserId()},e=this;e.$api.getMemberMessage(t).then((function(t){0===t.code&&t.data&&t.data.map((function(t){0===t.status&&(e.memberLevel=t.cardType)}))}))},chageMember:function(t){var e={1:"个人会员",2:"家庭会员",3:"家庭付费会员"};return e[t]},getActivityDetail:function(){var t=this;return new Promise((function(e){var i=t;i.$api.getActivityDetail({activityId:i.activityId,crtUserId:i.$utils.getUserId()}).then((function(t){if(0===t.code){if(!t.data)return void e();i.topicPostDetial=!0,i.topicPostObj=t.data}}))}))}}},u=l,p=(i("7bfc"),i("2877")),m=Object(p["a"])(u,s,a,!1,null,"fdc19c24",null);e["default"]=m.exports},a953:function(t,e,i){},ab13:function(t,e,i){var s=i("b622"),a=s("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[a]=!1,"/./"[t](e)}catch(s){}}return!1}},c623:function(t,e,i){"use strict";i("0a45")},caad:function(t,e,i){"use strict";var s=i("23e7"),a=i("4d64").includes,n=i("44d2");s({target:"Array",proto:!0},{includes:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),n("includes")},ea7f:function(t,e,i){},f602:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAC9UlEQVRYR8WXPWgVQRDH/xPie4WIVYSo4Ac2cfeCYhQsRO2CoIWSYKGQQiKKjSg2CprCws9O8KMwaKVBLaJYJpZiHg+TuZc0wSgSIWmEoIXkbuSO3HF3b+8jvhez3e3OzvzmY2f3CKs8aLn2Ozs7NzuOc4CIdotIGxFtALAAYBzA53K5PFKpVH4X1VsYwLKsfhHpA7C/gPLXIjJs2/ZgnmwugFKqj4guANiTpyy5LiKDjuMMTE1NzaTtzQRQSj0lIs/rRsY3ANeY+blJSSqAZVnvRaS7EcuJvQPMfCOpzwigtfYErzfRuK+KiHonJiaGonrrAFbKeMToUWZ+G3zHADo6OtpbW1vHRGRjhve/AHwCsBfA2iU501yaimFmPmYEKOj9PWa+rLW+C+DSkiLTXFYGwyjEIqCU+kJEW3Ny7xdTAtY0l6XmDTMf9+sikLIsq0dEXhYovGYAeGZ2MPN0CKC19oz3GAAWROQVEX0N1iIRCMWTcyKyhYhOAFiX4pTvSBSgCmCXQXiUmQ8XiEydiNZ6BMChlL0PmflcFOA7gE0mYRF5TEQ/lhmBdiLqzwD36yAK8AfAmgKeNqsG/MhGAX4CWL+aANMAttf1aqJZ13VvElEtkoJRrXUst8wcmxORnS0tLVczmlpdBD4C2GeIQIWZuwpExlSEYxnX+BAz90ZT8ADAeZMhIrJFZH5p7UPkyB1MmyOiNhFRaeDBxRQF8ELqHZu80XARisiMbdvbYp3Q+9BazwFoyyFoGABA+DaI3QVa69Q0BFBeT7Bt+6xS6lFwzk1zGaGfXVxc7JqcnPT7ShKgaBry0pS1HnsZ/W+AF8x8MkqXvI7PENGTRtzL2DvuOE53EPpALhmBdwCONBvAO8au6/bath02szoAy7JuiciVFTBedV33lMl4WIRKqYtEdL/Jxr3fszvlcvl21q8aaa1PA3jWROPDRDTiOM5orVbz3hiZwwNIezDk7Q3XRWSuVCrNV6vVoF0X3pv7b1hY0z8K/gWSX4MwlrsLLwAAAABJRU5ErkJggg=="}}]);