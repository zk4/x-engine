(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60748c9f"],{"2b08":function(e,t,s){},5624:function(e,t,s){"use strict";s("2b08")},a434:function(e,t,s){"use strict";var a=s("23e7"),r=s("23cb"),i=s("a691"),o=s("50c4"),n=s("7b0b"),c=s("65f0"),d=s("8418"),l=s("1dde"),A=l("splice"),u=Math.max,v=Math.min,h=9007199254740991,m="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!A},{splice:function(e,t){var s,a,l,A,p,g,f=n(this),I=o(f.length),w=r(e,I),C=arguments.length;if(0===C?s=a=0:1===C?(s=0,a=I-w):(s=C-2,a=v(u(i(t),0),I-w)),I+s-a>h)throw TypeError(m);for(l=c(f,a),A=0;A<a;A++)p=w+A,p in f&&d(l,A,f[p]);if(l.length=a,s<a){for(A=w;A<I-a;A++)p=A+a,g=A+s,p in f?f[g]=f[p]:delete f[g];for(A=I;A>I-a+s;A--)delete f[A-1]}else if(s>a)for(A=I-a;A>w;A--)p=A+a-1,g=A+s-1,p in f?f[g]=f[p]:delete f[g];for(A=0;A<s;A++)f[A+w]=arguments[A+2];return f.length=I-a+s,l}})},c0d9:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"release-evaluation"},[s("GmHeader",{attrs:{hideItem:["center"],slotsShow:["right"],leftText:"发布评价","background-color":"#fff"},scopedSlots:e._u([{key:"dynamicsRight",fn:function(){return[s("span",{staticClass:"header-right",on:{click:e.insetEvalute}},[e._v("发布")])]},proxy:!0}])}),s("div",{staticClass:"containers"},e._l(e.records,(function(t,a){return s("div",{key:a},[s("ul",e._l(t.orderItemList,(function(t,r){return s("li",{key:r,staticClass:"eva-list"},[s("div",{staticClass:"eva-details"},[s("van-image",{staticClass:"user-img",attrs:{src:t.mainPicUrl,"error-icon":e.defaultAvatar,fit:"cover"}}),s("div",{staticClass:"eva-message"},[s("p",{staticClass:"title"},[e._v(e._s(t.skuName))]),s("p",{staticClass:"details"},[s("span",[e._v(e._s(t.skuSpecValues))])])])],1),s("div",{staticClass:"rate-content"},[s("span",[e._v("描述相符：")]),s("van-rate",{attrs:{size:14,color:"#FF5F3B","void-color":"#FF5F3B"},model:{value:e.goodsRate[a][r],callback:function(t){e.$set(e.goodsRate[a],r,t)},expression:"goodsRate[indexs][index]"}})],1),s("van-field",{staticClass:"message",attrs:{rows:"3",autosize:"",type:"textarea",maxlength:"50",placeholder:"感觉怎么样？跟大家分享一下吧~","show-word-limit":""},model:{value:e.goodsMessage[a][r],callback:function(t){e.$set(e.goodsMessage[a],r,t)},expression:"goodsMessage[indexs][index]"}}),s("div",{staticClass:"imgs-upload"},[s("van-row",{staticClass:"img-list",attrs:{type:"flex",gutter:"8"}},[e._l(e.reviewsImg[a][r],(function(t,i){return s("van-col",{key:i,staticStyle:{position:"relative"},attrs:{span:"8"}},[s("van-image",{staticClass:"reviews-img",attrs:{src:t+"-dh300.jpg","error-icon":e.defaultAvatar,fit:"cover"},on:{click:function(t){return e.reviewImg(e.reviewsImg[a][r],i)}}}),s("span",{staticClass:"dele-icon",on:{click:function(t){return e.deleImg(a,r,i)}}})],1)})),e.reviewsImg[a][r]&&e.reviewsImg[a][r].length<3?s("van-col",{attrs:{span:"8"}},[e.environment?s("van-uploader",{attrs:{"after-read":e.afterRead(a,r)}}):e._e(),s("div",{staticClass:"upload-btn",on:{click:function(t){return e.showPhoto(a,r)}}},[s("span",{staticClass:"phone-icon"}),s("p",[e._v("上传图片")])])],1):e._e()],2)],1)],1)})),0),"catering"===e.type?s("div",{staticClass:"other-evals"},[s("p",{staticClass:"title"},[e._v(e._s(e._f("shopAliasName")(t)))]),s("div",{staticClass:"rate-content"},[s("span",[e._v("服务态度：")]),s("van-rate",{attrs:{size:14,color:"#FF5F3B","void-color":"#FF5F3B"},model:{value:e.caServiceRate[a],callback:function(t){e.$set(e.caServiceRate,a,t)},expression:"caServiceRate[indexs]"}})],1),s("div",{staticClass:"rate-content"},[s("span",[e._v("配送服务：")]),s("van-rate",{attrs:{size:14,color:"#FF5F3B","void-color":"#FF5F3B"},model:{value:e.caDistributionRate[a],callback:function(t){e.$set(e.caDistributionRate,a,t)},expression:"caDistributionRate[indexs]"}})],1)]):e._e(),"nomal"===e.type?s("div",{staticClass:"other-evals"},[s("p",{staticClass:"title"},[e._v(e._s(e._f("shopAliasName")(e.data)))]),s("div",{staticClass:"rate-content"},[s("span",[e._v("服务态度：")]),s("van-rate",{attrs:{size:14,color:"#FF5F3B","void-color":"#FF5F3B"},model:{value:e.serviceRate,callback:function(t){e.serviceRate=t},expression:"serviceRate"}})],1),s("div",{staticClass:"rate-content"},[s("span",[e._v("配送服务：")]),s("van-rate",{attrs:{size:14,color:"#FF5F3B","void-color":"#FF5F3B"},model:{value:e.DistributionRate,callback:function(t){e.DistributionRate=t},expression:"DistributionRate"}})],1)]):e._e(),"service"===e.type?s("div",{staticClass:"other-evals"},[s("p",{staticClass:"title"},[e._v("服务人员评价")]),s("div",{staticClass:"rate-content"},[s("span",[e._v("服务态度：")]),s("van-rate",{attrs:{size:14,color:"#FF5F3B","void-color":"#FF5F3B"},model:{value:e.attitudeRate,callback:function(t){e.attitudeRate=t},expression:"attitudeRate"}})],1),s("div",{staticClass:"rate-content"},[s("span",[e._v("技能水平：")]),s("van-rate",{attrs:{size:14,color:"#FF5F3B","void-color":"#FF5F3B"},model:{value:e.levelRate,callback:function(t){e.levelRate=t},expression:"levelRate"}})],1)]):e._e(),"service"===e.type?s("div",{staticClass:"other-evals"},[s("p",{staticClass:"title"},[e._v(e._s(e._f("shopAliasName")(e.data)))]),s("div",{staticClass:"rate-content"},[s("span",[e._v("服务态度：")]),s("van-rate",{attrs:{size:14,color:"#FF5F3B","void-color":"#FF5F3B"},model:{value:e.serviceRate,callback:function(t){e.serviceRate=t},expression:"serviceRate"}})],1)]):e._e()])})),0)],1)},r=[],i=(s("a434"),s("ac1f"),s("1276"),s("d3b7"),s("28a2")),o={name:"ReleaseEvaluation",components:{},data:function(){return{clickIndex:0,environment:this.$utils.isMiniprogram(),orderNo:this.$route.query.orderNo,orderType:this.$route.query.orderType,defaultAvatar:s("ee87"),imgCanvas:"https://img1.baidu.com/it/u=2496571732,442429806&fm=26&fmt=auto&gp=0.jpg",type:"service"===this.$route.query.from?"service":"catering"===this.$route.query.from?"catering":"nomal",value:5,message:"",reviewsImg:[],data:"",orderItemList:[],goodsRate:[],goodsMessage:[],caServiceRate:[],caDistributionRate:[],records:[],attitudeRate:5,levelRate:5,serviceRate:5,DistributionRate:5}},created:function(){this.toast(),"catering"===this.$route.query.from?this.getCateringDetail():this.getServiceDetail()},methods:{toast:function(){this.$toast.loading({duration:0,type:"loading",message:"加载中...",forbidClick:!0})},deleImg:function(e,t,s){this.reviewsImg[e][t].splice(s,1)},reviewImg:function(e,t){Object(i["a"])({images:e,startPosition:t,showIndex:!1,closeable:!0,closeIcon:"arrow-left",closeIconPosition:"top-left"})},getCateringDetail:function(){var e={state:"COMPLETE",orderType:this.$route.query.orderType,tradeNo:this.$route.query.tradeNo,pageNumber:"1",pageSize:"20"},t=this;t.$api.getUserQueryOrder(e).then((function(e){if(0===e.code){t.$toast.clear(),t.data=e.data,t.records=e.data.records;for(var s=0;s<t.records.length;s++){t.caServiceRate.push(5),t.caDistributionRate.push(5);var a=[];t.goodsRate.push([]),t.goodsMessage.push([]),t.reviewsImg.push([]);for(var r=0;r<e.data.records[s].orderItemList.length;r++)(e.data.records[s].orderItemList[r].repairOrderNo||e.data.records[s].orderItemList[r].finishAfterNumber!==e.data.records[s].orderItemList[r].number)&&a.push(e.data.records[s].orderItemList[r]),t.goodsRate[s].push(5),t.goodsMessage[s].push(""),t.reviewsImg[s].push([]);e.data.records[s].orderItemList=a}}})).catch((function(){}))},getServiceDetail:function(){var e=this,t={orderNo:this.orderNo,orderType:this.orderType};this.$api.ORDERDetail(t).then((function(t){if(0===t.code){e.$toast.clear(),e.data=t.data,e.records.push(t.data),e.goodsRate.push([]),e.goodsMessage.push([]),e.reviewsImg.push([]);for(var s=0;s<t.data.orderItemList.length;s++)(t.data.orderItemList[s].repairOrderNo||t.data.orderItemList[s].finishAfterNumber!==t.data.orderItemList[s].number)&&e.orderItemList.push(t.data.orderItemList[s]),e.goodsRate[0].push(5),e.goodsMessage[0].push(""),e.reviewsImg[0].push([]);e.records[0].orderItemList=e.orderItemList}})).catch((function(){}))},insetEvalute:function(){var e=this;this.toast();for(var t=[],s=0;s<this.records.length;s++)for(var a=0;a<this.records[s].orderItemList.length;a++){var r={};r.goodsGrade=this.goodsRate[s][a],r.orderCode=this.records[s].orderItemList[a].orderNo,r.skuCode=this.records[s].orderItemList[a].skuCode,r.spuCode=this.records[s].orderItemList[a].spuCode,r.spuName=this.records[s].orderItemList[a].spuName,r.shopCode=this.records[s].orderItemList[a].shopCode,r.shopName=this.$shopAliasName(this.records[s].orderItemList[a]),r.skuName=this.records[s].orderItemList[a].skuName,r.num=this.records[s].orderItemList[a].number,r.catFullName=this.records[s].orderItemList[a].catFullName,r.orderCrtTime=this.records[s].orderItemList[a].createTime,r.evaluateContent=this.goodsMessage[s][a],r.goodsGrade=this.goodsRate[s][a],r.mainPicUrl=this.records[s].orderItemList[a].mainPicUrl,r.orderType=this.$route.query.orderType,"service"===this.type?(r.shopGrade=this.serviceRate,r.serviceGrade=this.attitudeRate,r.skillGrade=this.levelRate):"nomal"===this.type?(r.shopGrade=this.serviceRate,r.logisticsGrade=this.DistributionRate):(r.shopGrade=this.caServiceRate[s],r.logisticsGrade=this.caDistributionRate[s]);for(var i=[],o=0;o<this.reviewsImg[s][a].length;o++){var n={};n.picUrl=this.reviewsImg[s][a][o],i.push(n)}i[0]&&(r.gmEvaluatePicBusinessParamList=i),t.push(r)}var c={evaluateList:t},d=this;this.$api.insetEvalute(c).then((function(t){0===t.code&&(d.$toast(t.message),setTimeout((function(){e.$utils.isMiniprogram()?(window.wx.miniProgram.navigateBack({delta:1}),setTimeout((function(){"/releaseEvaluation"===e.$route.path&&d.$router.go(-1)}),1e3)):d.$router.go(-1)}),1e3))})).catch((function(){}))},afterRead:function(e,t){var s=this;return function(a){s.upLoadImg(a.file.name,a.content.split(",")[1],e,t)}},showPhoto:function(e,t){var s=this;this.reviewsImg[e][t].length<3?this.$engine.api("com.zkty.jsi.camera","openImagePicker",{allowsEditing:!1,savePhotosAlbum:!1,cameraFlashMode:-1,cameraDevice:"back",photoCount:1,args:{bytes:"100"},isbase64:!0},(function(a){s.upLoadImg(JSON.parse(a).data[0].fileName,JSON.parse(a).data[0].retImage,e,t)})):this.$toast("最多可上传3张")},upLoadImg:function(e,t,s,a){var r=this;this.toast();var i={fileName:e,base64Str:t};this.$api.uploadBase64(i).then((function(e){0===e.code&&(r.$toast.clear(),r.reviewsImg[s][a].push(e.data.res.url))})).finally((function(e){}))}}},n=o,c=(s("5624"),s("2877")),d=Object(c["a"])(n,a,r,!1,null,null,null);t["default"]=d.exports},ee87:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAMAAABlApw1AAAAP1BMVEUAAAD4+Pj39/f29vb19fXw8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///8zJ5QuAAAABXRSTlMAJD2/7XxuZKkAAALNSURBVHja7dtrcqswDAVgEcDGIq4h1v7Xen/caZs2IQW/iqbnrEBfxgcZZkJEXc9K03dERJeBnTWjuhjreLgQdQNPo9JMPHTU651/HCfuid2oOI6JrWaAZWKjGWCYeFQdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACax1zXGNer0QpwUUREJDqdgPf5UwRnAJiP+UWiUQi4yl2uCgHrPWBVCIj3gAgAjtDfK7H6x+jpFtl0nac0wTmuEl5ExOu9zPn/P6ZvdPyKAzJOwykA9rOPViVgTV9JpwCE+50U9AFm+ZJZG2CKXwFx0gUwN/mWm1EFWOQhiyaAlyfxegAsT8NaAN8L3KrIpQCPBX5dZMOF/r9WChBkM8/22TWKxPlEAC8v4rcW3nwagIuvAA8X0/e+lOhHEYB9Of/DxfSzLwUWXRHAKj9k3epLOAUgyI8Jpb6i1ADMsiPzxsLIrkE+YIp7AB+Dfl8YuTXIBmxvsOeDhj1roiVgkZ1ZHgtQoga5AC+74zcWRt73i0wAy4HwxnnLqkEeYF+BP4u8vDpdvwDYW+APwf7bUhtAkELJqEEOwEuxpH/GywC4WA6Q/hkvHWBLzi/y1hywStlwY0AoPH9qDVIBsxTP2hIwxfKAtBqkAY5usJ2ZmwGWKvMnvd0kAbxUymqaAFiqJbQAVClw8tvNcUClAqfW4DggSNUcfbs5DPBSOaEuwMXagIM1OAiw9ec/+HZzELBKgxyqwTHALE3yVg0Q2gBuAPzyEfL1SrwoL/E4+lvtB+ntzdS9SpwsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAGM3zGya2mgGWiZ1mgGPqedI7/8Q9dYNewcRDR3QZ2FmFTTbW8XAhIup6Vpq+I/oHlUqlUPej+ikAAAAASUVORK5CYII="}}]);