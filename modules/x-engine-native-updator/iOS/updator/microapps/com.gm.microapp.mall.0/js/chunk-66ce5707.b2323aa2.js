(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66ce5707"],{9674:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"min"},[e("gm-header",{attrs:{hideItem:["center",""+(this.$utils.isMiniprogram()&&"right")],slotsShow:["right"],leftText:"我的家庭","background-color":"#fff"},scopedSlots:t._u([{key:"dynamicsRight",fn:function(){return[e("span",{on:{click:t.handleShare}},[t._v("邀请家人")])]},proxy:!0}])}),e("p",{staticClass:"min-tip"},[t._v("家庭成员最多"+t._s(t.maxNum)+"人，当前已有"+t._s(t.num)+"人")]),e("div",{staticClass:"min-container"},t._l(t.memberList,(function(i,n){return e("div",{key:n,staticClass:"min-container-boxs"},[e("img",{staticClass:"min-container-boxs-img",attrs:{src:i.memberImage,alt:""}}),e("div",{staticClass:"min-container-boxs-text"},[e("p",{staticClass:"min-container-boxs-text-name"},[t._v(t._s(i.memberName))]),e("p",{staticClass:"min-container-boxs-text-title"},[t._v(t._s(0===i.isMaster?"户主":i.tag)),1===i.isMaster&&"0"===t.isMaster?e("i",{staticClass:"min-container-boxs-text-title-icon",on:{click:function(e){return t.handleEdit(i)}}}):t._e()])]),1===i.isMaster&&"0"===t.isMaster?e("div",{staticClass:"min-container-boxs-btn",on:{click:function(e){return t.handleRemove("master",i)}}},[t._v("移除成员")]):t._e()])})),0),"1"===t.isMaster?e("div",{staticClass:"min-footer"},[e("div",{staticClass:"min-footer-btn",on:{click:function(i){return t.handleRemove("user")}}},[t._v("退出家庭")])]):t._e(),e("van-popup",{attrs:{position:"bottom"},model:{value:t.visible,callback:function(i){t.visible=i},expression:"visible"}},[e("div",{staticClass:"min-popup"},[e("p",{staticClass:"min-popup-title"},[t._v("请选择家庭关系")]),e("div",{staticClass:"min-popup-cont"},t._l(t.relationList,(function(i,n){return e("div",{key:n,class:["min-popup-cont-boxs",t.activeIndex===n&&"active"],on:{click:function(e){return t.handlePopupBox(i,n)}}},[t._v(t._s(i.dictLabel))])})),0),e("div",{staticClass:"min-popup-footer"},[e("div",{staticClass:"min-popup-footer-btns min-popup-footer-cancel",on:{click:function(i){t.visible=!1}}},[t._v("取消")]),e("div",{staticClass:"min-popup-footer-btns min-popup-footer-comfirm",on:{click:t.handleConfirm}},[t._v("确定")])])])])],1)},s=[],a=(e("4e82"),e("365c")),r=e("2241"),o={name:"MinFamily",data:function(){return{relationList:[],visible:!1,activeIndex:null,memberList:[],relationTag:"",maxNum:0,num:0,memberCardId:this.$route.query.memberCardId,isMaster:this.$route.query.isMaster}},mounted:function(){document.body.style.backgroundColor="#f9f9f9",this.$utils.isMiniprogram()&&this.$route.query.userToken&&this.$utils.storage.set("GMJUserInfo",this.$route.query.userInfo)},created:function(){this.init(),this.getRelationList()},methods:{init:function(){var t=this,i={memberCardId:this.memberCardId};a["a"].getMemberList(i).then((function(i){t.memberList=i&&i.data&&i.data.sort((function(t,i){return t.isMaster-i.isMaster}))})),this.checkNum()},checkNum:function(){var t=this,i={memberCardId:this.memberCardId,memberCardType:this.$route.query.memberCardType};a["a"].checkFamilyNum(i).then((function(i){t.maxNum=i.data.maxNum,t.num=i.data.num}))},handlePopupBox:function(t,i){this.activeIndex=i,this.relationTag=t.dictLabel},handleEdit:function(t){this.visible=!0,this.id=t.id},handleConfirm:function(t){var i=this,e={id:this.id,optUserId:this.$utils.getUserId(),tag:this.relationTag};a["a"].updateTag(e).then((function(t){i.visible=!1,i.init()}))},handleRemove:function(t,i){var e=this,n={memberCardId:this.memberCardId,optUserId:this.$utils.getUserId(),userId:"user"===t?this.$utils.getUserId():i.userId,masterUserId:this.memberList[0].userId,memberCardType:this.$route.query.memberCardType};a["a"].getMemberGroupReenterDay().then((function(s){r["a"].confirm({title:"user"===t?"是否确认退出家庭":"是否确认移除家庭成员",message:"user"===t?0===s.data.value?"是否确认退出家庭？":"是否确认退出家庭？一旦退出".concat(s.data.value,"天内不能加入新的家庭。"):"是否确认将".concat(i.memberName,"移除家庭会员?")}).then((function(){a["a"].removeFamily(n).then((function(i){"user"===t?e.$utils.isMiniprogram()?window.wx.miniProgram.navigateBack({delta:1}):e.$router.go(0):e.init()}))})).catch((function(){}))}))},getRelationList:function(){var t=this,i={dictType:"FAMILY_RELATIONSHIP"};a["a"].getRelationLsit(i).then((function(i){t.relationList=i.data.list}))},handleShare:function(){var t=this;this.$engine.api("com.zkty.jsi.gmshare","openShareUi",{channelList:[{channel:"wx_friend",shareType:"miniProgram"}]},(function(i){t.$engine.api("com.zkty.jsi.share","share",{channel:"wx_friend",type:"miniProgram",info:{userName:"gh_bf12178b86e9",path:"/pages/joinFamily/joinFamily?userId=".concat(t.$utils.getUserId()),link:1,miniProgramType:0,title:"邀请家人",desc:"快来加入的家庭，领取家庭会员卡，专享咱们家的特权~",imgUrl:"https://gfs16.gomein.net.cn/T14R_WBsZv1RCvBVdK"}},(function(t){}))}))}}},c=o,m=(e("d096"),e("2877")),u=Object(m["a"])(c,n,s,!1,null,"cd714fb8",null);i["default"]=u.exports},d096:function(t,i,e){"use strict";e("fe68")},fe68:function(t,i,e){}}]);