(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77d185c7"],{"3bdd":function(t,e,n){"use strict";n("e3e9")},4945:function(t,e,n){"use strict";n("85d8")},"4fae":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"records"},[n("gm-header",{attrs:{hideItem:["center","right"],slotsShow:["right"],leftText:"使用记录","background-color":"#fff"}}),n("div",{staticClass:"records-main"},[n("div",{staticClass:"records-main-tab"},[n("div",{class:["records-main-tab-btns","BEEN_USED"===t.current&&"active"],on:{click:function(e){return t.handleFilter("BEEN_USED")}}},[t._v("已使用")]),n("div",{class:["records-main-tab-btns","USABLE"===t.current&&"active"],on:{click:function(e){return t.handleFilter("USABLE")}}},[t._v("已过期")])]),n("listPagination",{ref:"listPagination",attrs:{"data-list":t.records,formatAjaxData:t.init,isRefresh:t.isRefresh,slotsShow:["finished","error"]},on:{"update:dataList":function(e){t.records=e},"update:data-list":function(e){t.records=e},"update:isRefresh":function(e){t.isRefresh=e},"update:is-refresh":function(e){t.isRefresh=e}},scopedSlots:t._u([{key:"finished",fn:function(){return[n("div",{staticClass:"reminder"},[t.records.length?n("div",[t._v("没有更多了")]):n("div",{staticClass:"records-main-notData"},[n("div",{staticClass:"records-main-notData-bg"}),n("p",[t._v("没有"+t._s("BEEN_USED"===t.current?"使用过":"过期")+"的优惠券哟")])])])]},proxy:!0},{key:"error",fn:function(){return[n("div",[t._v("请求失败，点击重新加载")])]},proxy:!0}])},[n("div",{staticClass:"records-main-coupons"},t._l(t.records,(function(e,s){return n("div",{key:s,staticClass:"records-main-coupons-box"},[n("Coupons",{attrs:{type:e.type,cardNo:e.recordCardNo,couponUrl:e.couponUrl,usedTip:e.instructions,money:e.money,condition:e.condition,time:e.date,status:e.status,isOverdue:"BEEN_USED"===t.current?"已使用":"已过期",notStart:e.notStart,title:e.title}})],1)})),0)])],1)],1)},o=[],a=n("2909"),i=n("5530"),r=(n("d3b7"),n("d81d"),n("365c")),c=n("a2ab"),d=n("c1df"),u=n.n(d),p={name:"CouponsRecords",components:{Coupons:c["a"]},data:function(){return{current:"BEEN_USED",records:[],isRefresh:!1}},mounted:function(){document.body.style.backgroundColor="#f9f9f9"},methods:{init:function(t){var e=this,n={param:{status:this.current,userId:this.$utils.getUserId()},pageNumber:t.page,pageSize:10};return this.$toast.loading({duration:0,type:"loading",message:"加载中...",forbidClick:!0}),new Promise((function(s,o){1===t.page&&(e.records=[]),r["a"].getUsageRecord(n).then((function(t){var n,o=t.data.records.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{couponUrl:t.couponCover,money:"LAPSE"===t.treatmentMethod?"￥"+t.directReductionAmount:"FULL_REDUCTION"===t.treatmentMethod?"￥"+t.fullReductionAmount:10*t.deductionRate+"折",condition:"LAPSE"===t.treatmentMethod?"无门槛":"满".concat(t.fullDecrementConditionAmount,"元可用"),date:"截止日期："+u()(t.endDate).format("YYYY.MM.DD"),notStart:u()().valueOf()-u()(t.startDate).valueOf()<1?"未生效":"",status:"notUsed"})}));(n=e.records).push.apply(n,Object(a["a"])(o));var r={pageCount:t.data.pages};s(r),e.$toast.clear()})).catch((function(t){o(t),e.$toast.clear()}))}))},handleFilter:function(t){this.current=t,this.init({page:1})}}},l=p,f=(n("3bdd"),n("2877")),v=Object(f["a"])(l,s,o,!1,null,"7e160aa4",null);e["default"]=v.exports},"85d8":function(t,e,n){},a2ab:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return"01"===t.awardTypeCode?n("div",{class:["coupons","notUsed"===t.status?"notUsed":"SHOP"===t.type?"shop-bg":"platform-bg"]},[t.isOverdue||t.notStart?n("i",{staticClass:"coupons-overdue"},[t._v(t._s(t.notStart?t.notStart:t.isOverdue))]):t._e(),n("div",{staticClass:"coupons-info"},[n("div",{staticClass:"coupons-info-left"},[n("img",{attrs:{src:t.couponUrl,alt:""}}),n("p",{class:["coupons-info-left-type","SHOP"===t.type?"shop":"platform"]},[t._v(t._s("SHOP"===t.type?"店铺":"平台"))])]),n("div",{staticClass:"coupons-info-center"},[n("span",{staticClass:"coupons-info-center-money"},[t._v(t._s(t.money))]),n("span",{staticClass:"coupons-info-center-rule"},[t._v(t._s(t.condition))]),n("p",{staticStyle:{margin:"6px 0 2px 0"}},[t._v(t._s(t.title))]),n("p",{staticClass:"coupons-info-center-date"},[t._v(t._s(t.time))])]),"notUsed"!==t.status?n("div",{staticClass:"coupons-info-right",on:{click:function(e){return t.handleUsed(t.cardNo)}}},[t._v(" "+t._s(t.notStart?"去看看":"去使用")+" ")]):t._e()]),n("div",{class:["coupons-tip","notUsed"===t.status?"notUsed-tip":"SHOP"===t.type?"shop-tip":"platform-tip"]},[t.tipShow?n("p",[n("span",[t._v("券编号：")]),n("span",[t._v(t._s(t.cardNo))])]):t._e(),t.tipShow?n("p",{staticStyle:{whiteSpace:"pre-line"}},[t._v(t._s(t.usedTip))]):t._e(),n("div",{staticClass:"coupons-tip-icon",on:{click:function(e){t.tipShow=!t.tipShow}}},[n("van-icon",{attrs:{name:t.tipShow?"arrow-up":"arrow-down"}})],1)])]):n("div",{staticClass:"coupons-ths"},[n("div",{staticClass:"coupons-ths-icon"},[n("van-icon",{attrs:{name:"smile-o"}})],1),n("p",{staticClass:"coupons-ths-text"},[t._v(t._s(t.activityAwardName))])])},o=[],a={props:{activityAwardName:{type:String},notStart:{type:String,default:""},title:{type:String,default:""},awardTypeCode:{type:String,default:"01"},couponUrl:{type:String},money:{type:String,default:""},type:{type:String,default:"SHOP"},cardNo:{type:String},usedTip:{type:String},condition:{type:String},time:{type:String},status:{type:String},handleUsed:{type:Function},isOverdue:{type:String}},data:function(){return{tipShow:!1}}},i=a,r=(n("4945"),n("2877")),c=Object(r["a"])(i,s,o,!1,null,"86d1be7e",null);e["a"]=c.exports},e3e9:function(t,e,n){}}]);