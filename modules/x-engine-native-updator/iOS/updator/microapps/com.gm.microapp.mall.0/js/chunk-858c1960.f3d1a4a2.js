(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-858c1960"],{1257:function(t,a,e){},"46e3":function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"goods"},[e("GmHeader",{attrs:{search:!0,searchBackColor:!0,cart:!0,placeholder:"搜索",wordVal:t.saleName},on:{search:t.onSearch,"update:wordVal":function(a){t.saleName=a},"update:word-val":function(a){t.saleName=a}}}),e("div",{staticClass:"goods-main"},[e("div",{staticClass:"goods-main-tip"},[e("van-notice-bar",{attrs:{scrollable:"",text:t.couponTip}})],1),e("div",{staticClass:"goods-main-tab"},t._l(t.tabList,(function(a,o){return e("div",{key:o,class:["goods-main-tab-boxs",t.tab===a.type&&"active"],on:{click:function(e){return t.handleFiltre(a.type)}}},[t._v(" "+t._s(a.label)+" "),e("i",{class:["goods-main-tab-boxs-icon",a.value?"down":"up"]})])})),0),e("listPagination",{ref:"listPagination",attrs:{"data-list":t.goodsList,formatAjaxData:t.init,isRefresh:t.isRefresh,slotsShow:["finished","error"]},on:{"update:dataList":function(a){t.goodsList=a},"update:data-list":function(a){t.goodsList=a},"update:isRefresh":function(a){t.isRefresh=a},"update:is-refresh":function(a){t.isRefresh=a}},scopedSlots:t._u([{key:"finished",fn:function(){return[e("div",{staticClass:"reminder"},[t.goodsList.length?e("div",[t._v("没有更多了")]):e("div",{staticClass:"error-body"},[e("div",{staticClass:"error-text"},[t._v("暂无记录")])])])]},proxy:!0},{key:"error",fn:function(){return[e("div",[t._v("请求失败，点击重新加载")])]},proxy:!0}])},[e("div",{staticClass:"goods-main-cont"},t._l(t.goodsList,(function(a,o){return e("div",{key:o,staticClass:"goods-main-cont-boxs"},[e("div",{staticClass:"goods-main-cont-boxs-img",on:{click:function(e){return t.handleLink(a)}}},[e("img",{attrs:{src:a.mainPicUrl,alt:""}})]),e("div",{staticClass:"goods-main-cont-boxs-info"},[e("p",{staticClass:"goods-main-cont-boxs-info-title",on:{click:function(e){return t.handleLink(a)}}},[t._v(t._s(a.saleName))]),e("span",{staticClass:"goods-main-cont-boxs-info-tip"},[t._v(t._s(a.salesVolume)+"付款")]),e("div",{staticClass:"goods-main-cont-boxs-info-footer"},[e("span",{staticClass:"goods-main-cont-boxs-info-footer-money"},[t._v("￥"+t._s(a.salePrice))]),e("span",{staticClass:"goods-main-cont-boxs-info-footer-link",on:{click:function(e){return t.handleShop(a)}}},[t._v("进店"),e("van-icon",{staticStyle:{verticalAlign:"middle",marginLeft:"3px",fontWeight:"bold"},attrs:{name:"arrow"}})],1)])])])})),0)])],1)],1)},s=[],i=e("2909"),n=e("ade3"),c=(e("99af"),e("d3b7"),e("365c")),r=e("c1df"),d=e.n(r),l={name:"CouponGoods",data:function(){return{tabList:[{label:"销量",type:"sale",value:!0},{label:"价格",type:"price",value:!0}],tab:"sale",saleName:"",price:null,sale:null,goodsList:[],isRefresh:!1,couponTip:""}},mounted:function(){document.body.style.backgroundColor="#f9f9f9",this.getDetail()},methods:{onSearch:function(t){this.saleName=t,this.init({page:1})},getDetail:function(){var t=this,a={recordNo:this.$route.query.cardNo};c["a"].getCouponGoodsDetail(a).then((function(a){t.couponType=a.data.treatmentMethod,"LAPSE"===a.data.treatmentMethod?t.couponTip="以下商品可使用".concat(a.data.directReductionAmount,"元的优惠券。有效期至").concat(d()(a.data.endDate).format("YYYY-MM-DD")):"FULL_REDUCTION"===a.data.treatmentMethod?t.couponTip="以下商品可使用满".concat(a.data.fullDecrementConditionAmount,"元减").concat(a.data.fullReductionAmount,"的优惠券。有效期至").concat(d()(a.data.endDate).format("YYYY-MM-DD")):t.couponTip="以下商品可使用满".concat(a.data.fullDecrementConditionAmount,"元打").concat(10*a.data.deductionRate,"折的优惠券，最高优惠").concat(a.data.maximumDeductionAmount,"元。有效期至").concat(d()(a.data.endDate).format("YYYY-MM-DD"))}))},init:function(t){var a,e=this,o={param:(a={recordCardNo:this.$route.query.cardNo},Object(n["a"])(a,this.tab,this[this.tab]?2:1),Object(n["a"])(a,"city",this.$cityCode),Object(n["a"])(a,"mallCode",this.$mallCode),Object(n["a"])(a,"saleName",this.saleName),Object(n["a"])(a,"userId",this.$utils.getUserId()),a),pageNumber:t.page,pageSize:10};return new Promise((function(a,s){1===t.page&&(e.goodsList=[]),c["a"].getCouponGoods(o).then((function(t){var o;(o=e.goodsList).push.apply(o,Object(i["a"])(t.data.records));var s={pageCount:t.data.pages};a(s)})).catch((function(t){s(t)}))}))},handleFiltre:function(t){this.tab=t,"sale"===t?(this.sale=!this.sale,this.tabList[0].value=!this.sale):(this.price=!this.price,this.tabList[1].value=!this.price),this.init({page:1})},handleLink:function(t){this.$router.push({path:"NORMAL"===t.goodsType?"/goodsDetail":"/serviceGoodsDetail",query:{skuCode:t.skuCode,shopCode:t.shopCode}})},toast:function(){this.$toast.loading({duration:0,type:"loading",message:"加载中...",forbidClick:!0})},handleShop:function(t){var a=this;this.toast();var e={code:t.shopCode};this.$api.getStoreInfo(e).then((function(e){if(e&&0===e.code){a.$toast.clear();var o="/shop",s={id:t.shopCode};switch(e.data.shopInfo.pattern){case"01":o="/staffRestaurant";break;case"02":s.shopType=1;break;case"03":s.shopType=2;break;case"04":o="/staffRestaurant";break;case"05":break;case"06":break;case"07":break;case"08":break;case"09":break;case"10":o="/staffRestaurant";break;case"11":o="/restaurantArea";break;case"12":break;case"13":break;case"14":break;case"15":break}a.$router.push({path:o,query:s})}}))}}},u=l,f=(e("635d"),e("2877")),h=Object(f["a"])(u,o,s,!1,null,"0f7a6bf3",null);a["default"]=h.exports},"635d":function(t,a,e){"use strict";e("1257")}}]);